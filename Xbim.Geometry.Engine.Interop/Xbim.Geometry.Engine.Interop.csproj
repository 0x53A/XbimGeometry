<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net47</TargetFramework>
    <SignAssembly>True</SignAssembly>
    <AssemblyOriginatorKeyFile>aimkey.snk</AssemblyOriginatorKeyFile>
    <Title>Xbim Geometry Engine</Title>
    <Version>5.0.0-Unreleased</Version>
    <Copyright>Copyright Xbim Ltd.</Copyright>
    <Description>.net library that provides support for the  Ifc4 and Ifc2x3 Geometry conversion.</Description>
    <Authors>Steve Lockley</Authors>
    <Company>Xbim Ltd.</Company>
    <PackageLicenseUrl>https://raw.githubusercontent.com/xBimTeam/XbimEssentials/master/LICENCE.md</PackageLicenseUrl>
    <PackageProjectUrl>https://github.com/xBimTeam/</PackageProjectUrl>
    <RepositoryUrl></RepositoryUrl>
    <PackageTags>BIM, IFC, IfcXml, IfcZip, Ifc4,  COBie, .Net, C#, BuildingSmart</PackageTags>
    <PackageReleaseNotes>migrated Xbim.Geometry.Interop to .net47</PackageReleaseNotes>
    <AssemblyVersion>5.0.0.0</AssemblyVersion>
    <FileVersion>5.0.0.0</FileVersion>
    <GeneratePackageOnBuild>false</GeneratePackageOnBuild>
    <PackageIconUrl>https://avatars1.githubusercontent.com/u/2284875?v=3&amp;amp;s=240</PackageIconUrl>
  </PropertyGroup>


  <ItemGroup>
    <PackageReference Include="Xbim.Ifc4" Version="5.0.0-Beta-249" />
    <PackageReference Include="Xbim.Tessellator" Version="5.0.0-Beta-253" />
  </ItemGroup>
  <ItemGroup>
    <Reference Include="System.Configuration" />
  </ItemGroup>
  <PropertyGroup>
    <Year>$([System.DateTime]::Now.ToString("yy"))</Year>
    <Month>$([System.DateTime]::Now.ToString("MM"))</Month>
    <Day>$([System.DateTime]::Now.ToString("dd"))</Day>
    <Minute>$([System.Int32]::Parse($([System.DateTime]::Now.ToString("mm"))))</Minute>
    <Hour>$([System.Int32]::Parse($([System.DateTime]::Now.ToString("HH"))))</Hour>
    <MinuteOfDay>$([MSBuild]::Add($(Minute),$([MSBuild]::Multiply($(Hour),60))))</MinuteOfDay>
    <HalfMinuteOfDay>$([System.Convert]::ToInt16($([MSBuild]::Divide($(MinuteOfDay), 2))))</HalfMinuteOfDay>
    <AssemblyFileVersionAttribute>[assembly:System.Reflection.AssemblyFileVersion("4.0.$(Year)$(Month).$(Day)$(HalfMinuteOfDay)")];</AssemblyFileVersionAttribute>
  </PropertyGroup>

  <ItemGroup>
    <Content Include="bin\$(Configuration)\net47\x86\Xbim.Geometry.Engine.dll">
      <Pack>true</Pack>
      <PackagePath>build\net47\x86;</PackagePath>
    </Content>
    <Content Include="bin\$(Configuration)\net47\x64\Xbim.Geometry.Engine.dll">
      <Pack>true</Pack>
      <PackagePath>build\net47\x64;</PackagePath>
    </Content>
    <Content Include="..\Xbim.Geometry.targets">
      <Link>Xbim.Geometry.targets</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
      <PackagePath>build\;</PackagePath>
      <Pack>true</Pack>
    </Content>
  </ItemGroup>
  <Target Name="BuildNativeCodeEngine" BeforeTargets="Build">
    <Message Text="Building Xbim.Geometry.Engine Native Dlls" Importance="High" />
    <WriteLinesToFile File="..\SharedFileVersionInfo.cs" Lines="$(AssemblyFileVersionAttribute)" Overwrite="true" Encoding="Unicode" />
    <MSBuild Projects="$(MSBuildProjectDirectory)\..\Xbim.Geometry.Engine\Xbim.Geometry.Engine.vcxproj" Properties="Configuration=$(Configuration);Platform=Win32;OutDir=..\Xbim.Geometry.Engine.Interop\bin\$(Configuration)\net47\x86\" Targets="Build">
      <Output ItemName="AssembliesBuiltByChildProjects" TaskParameter="TargetOutputs" />
    </MSBuild>
    <MSBuild Projects="$(MSBuildProjectDirectory)\..\Xbim.Geometry.Engine\Xbim.Geometry.Engine.vcxproj" Properties="Configuration=$(Configuration);Platform=x64;OutDir=..\Xbim.Geometry.Engine.Interop\bin\$(Configuration)\net47\x64\" Targets="Build">
      <Output ItemName="AssembliesBuiltByChildProjects" TaskParameter="TargetOutputs" />
    </MSBuild>  
  </Target>

</Project>